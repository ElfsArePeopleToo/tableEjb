<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">


<h:head>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
    <h:outputStylesheet library="css" name="bootstrap-reboot.min.css"/>
    <h:outputStylesheet library="css" name="bootstrap-reboot.min.css"/>
    <h:outputStylesheet library="css" name="index.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>ejb</title>
</h:head>

<h:body>
    <h3 align="center">Orders Information</h3>
    <table class ="table table-sm table-striped">
        <thead>
        <tr>
            <th scope="col" class="order-table-header">Order number</th>
            <th scope="col" class="order-table-header">Order status</th>
            <th scope="col" class="order-table-header">Waggon</th>
            <th scope="col" class="order-table-header">Drivers</th>
            <th scope="col" class="order-table-header">WayPoints</th>
        </tr>
        </thead>
        <tbody>

        <ui:repeat id = "orders" var="item" value="#{loadInfo.info}">
            <tr>
                <td scope="row" class="order-table-row">#{item.regNumberOrder}</td>
                <td class="order-table-row">#{item.orderStatus}</td>
                <td class="order-table-row">#{item.regNumber}</td>
                <td class="order-table-row">#{item.drivers}</td>
                <td class="order-table-row">#{item.wayPoints}</td>
            </tr>
        </ui:repeat>

        <f:websocket channel="update" >
            <f:ajax event="update" render=":orders"/>
        </f:websocket>

        </tbody>
    </table>
<h3 align="center">Drivers</h3>
<h:dataTable class ="table table-border" id = "drivers" value = "#{loadInfo.infoDriver}" var ="driverItem">
    <h:column scope="col" library="javax.faces" name="jsf.js" target="head">
           <f:facet scope="row" name="header">All drivers</f:facet>
            #{loadInfo.infoDriver.driversCount}
    </h:column>
    <h:column scope="col" library="javax.faces" name="jsf.js" target="head">
        <f:facet name="header">Busy drivers</f:facet>
            #{loadInfo.infoDriver.busyDriversCount}
    </h:column>
    <h:column scope="col" library="javax.faces" name="jsf.js" target="head">
        <f:facet name="header">Free drivers</f:facet>
            #{loadInfo.infoDriver.freeDriversCount}
    </h:column>
</h:dataTable>

    <h:form>
        <f:websocket channel="update" >
            <f:ajax event="update" render=":drivers"/>
        </f:websocket>
    </h:form>
    <h3 align="center">Waggons</h3>
<h:dataTable class ="table table-border"  id = "waggons" value = "#{loadInfo.infoWaggon}" var ="waggonItem">
    <h:column library="javax.faces" name="jsf.js" target="head">
        <f:facet name="header">All waggons</f:facet>
          #{loadInfo.infoWaggon.allWaggonsCount}
    </h:column>

    <h:column library="javax.faces" name="jsf.js" target="head">
    <f:facet name="header">Broken waggons</f:facet>
        #{loadInfo.infoWaggon.brokenWaggonCount}
    </h:column>

    <h:column library="javax.faces" name="jsf.js" target="head">
    <f:facet name="header">Working waggons</f:facet>
        #{loadInfo.infoWaggon.workingWaggonCount}
    </h:column>

    <h:column library="javax.faces" name="jsf.js" target="head">
    <f:facet name="header">Free waggons</f:facet>
        #{loadInfo.infoWaggon.freeWaggonsCount}
    </h:column>

    <h:column library="javax.faces" name="jsf.js" target="head">
    <f:facet name="header">Busy waggons</f:facet>
        #{loadInfo.infoWaggon.busyWaggonsCount}
    </h:column>
</h:dataTable>
    <h:form>
        <f:websocket channel="update" >
            <f:ajax event="update" render=":waggons"/>
        </f:websocket>
    </h:form>
</h:body>

</html>