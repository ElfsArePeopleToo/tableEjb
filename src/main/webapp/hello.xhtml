<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">


<h:head>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
    <h:outputStylesheet library="css" name="bootstrap-reboot.min.css"/>
    <h:outputStylesheet library="css" name="bootstrap-reboot.min.css"/>
    <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
    <title>ejb</title>
</h:head>

<h:body>
    <h1>Orders Information</h1>
    <table class ="table table-bordered">
        <thead>
        <tr>
            <th scope="col" class="order-table-header">Order number</th>
            <th scope="col" class="order-table-header">Order status</th>
            <th scope="col" class="order-table-header">Waggon</th>
            <th scope="col" class="order-table-header">Drivers</th>
            <th scope="col" class="order-table-header">WayPoints</th>
        </tr>
        </thead>
        <tbody>

        <ui:repeat id = "orders" var="item" value="#{loadInfo.info}">
            <tr>
                <td scope="row" class="order-table-row">#{item.regNumberOrder}</td>
                <td class="order-table-row">#{item.orderStatus}</td>
                <td class="order-table-row">#{item.regNumber}</td>
                <td class="order-table-row">#{item.drivers}</td>
                <td class="order-table-row">#{item.wayPoints}</td>
            </tr>
        </ui:repeat>

        <f:websocket channel="update" >
            <f:ajax event="update" render=":orders"/>
        </f:websocket>

        </tbody>
    </table>


<h:dataTable id = "drivers" value = "#{loadInfo.infoDriver}" var ="driverItem">
    <h:column library="javax.faces" name="jsf.js" target="head">
           <f:facet name="header">All drivers</f:facet>
            #{loadInfo.infoDriver.driversCount}
    </h:column>
    <h:column library="javax.faces" name="jsf.js" target="head">
        <f:facet name="header">All busy drivers</f:facet>
            #{loadInfo.infoDriver.busyDriversCount}
    </h:column>
    <h:column library="javax.faces" name="jsf.js" target="head">
        <f:facet name="header">All free drivers</f:facet>
            #{loadInfo.infoDriver.freeDriversCount}"
    </h:column>
</h:dataTable>

    <h:form>
        <f:websocket channel="update" >
            <f:ajax event="update" render=":drivers"/>
        </f:websocket>
    </h:form>

    <h:outputText library="javax.faces" name="jsf.js" target="head" id = "waggons" value = "
    #{loadInfo.infoWaggon.allWaggonsCount}
    #{loadInfo.infoWaggon.brokenWaggonCount}
    #{loadInfo.infoWaggon.workingWaggonCount}
    #{loadInfo.infoWaggon.freeWaggonsCount}
    #{loadInfo.infoWaggon.busyWaggonsCount}">

        <f:websocket channel="update" >
            <f:ajax event="update" render=":waggons"/>
        </f:websocket>
    </h:outputText>
</h:body>


</html>